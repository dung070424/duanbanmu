<div class="dashboard">
  <div class="page-header">
    <h1><i class="bi bi-graph-up"></i> Dashboard</h1>
    <p>Biểu đồ thống kê tổng quan hệ thống</p>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card" *ngFor="let card of statCards">
      <div class="stat-icon">
        <i [class]="card.icon"></i>
      </div>
      <div class="stat-content">
        <h3>{{ card.value }}</h3>
        <p>{{ card.title }}</p>
        <span class="stat-change" [ngClass]="getChangeClass(card.changeType)">
          {{ card.change }}
        </span>
      </div>
    </div>
  </div>

  <!-- Charts Grid -->
  <div class="charts-grid">
    <!-- Line Chart: Doanh thu 7 ngày -->
    <div class="content-card">
      <div class="card-header">
        <h3><i class="bi bi-activity"></i> Doanh thu 7 ngày gần nhất</h3>
      </div>
      <div class="card-body">
        <div class="line-chart">
          <svg
            [attr.viewBox]="'0 0 ' + lineChartWidth + ' ' + lineChartHeight"
            preserveAspectRatio="none"
          >
            <defs>
              <linearGradient id="lineFill" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#4f46e5" stop-opacity="0.25" />
                <stop offset="100%" stop-color="#4f46e5" stop-opacity="0" />
              </linearGradient>
            </defs>
            <path class="line-fill" [attr.d]="lineAreaPath" fill="url(#lineFill)"></path>
            <path class="line-path" [attr.d]="linePath"></path>
            <g *ngFor="let p of linePoints">
              <circle class="line-dot" [attr.cx]="p.x" [attr.cy]="p.y" r="3"></circle>
            </g>
          </svg>
          <div class="x-labels">
            <span *ngFor="let d of last7Days">{{ d }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Bar Chart: Doanh thu theo danh mục -->
    <div class="content-card">
      <div class="card-header">
        <h3><i class="bi bi-bar-chart"></i> Doanh thu theo danh mục</h3>
      </div>
      <div class="card-body">
        <div class="bar-chart">
          <div
            class="bar"
            *ngFor="let c of categoryRevenues"
            [style.height.%]="(c.value / maxCategoryValue) * 100"
          >
            <span class="bar-value">{{ c.value | number }}</span>
            <span class="bar-label">{{ c.name }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Donut Chart: Trạng thái tồn kho -->
    <div class="content-card">
      <div class="card-header">
        <h3><i class="bi bi-pie-chart"></i> Tỷ lệ trạng thái tồn kho</h3>
      </div>
      <div class="card-body">
        <div class="donut-chart">
          <svg viewBox="0 0 120 120">
            <g transform="translate(60,60)">
              <circle class="donut-bg" r="45"></circle>
              <ng-container *ngFor="let s of donutSegments; let i = index">
                <circle
                  class="donut-seg"
                  r="45"
                  [attr.stroke-dasharray]="s.arc + ' ' + (circumference - s.arc)"
                  [attr.stroke-dashoffset]="s.offset"
                  [style.stroke]="s.color"
                ></circle>
              </ng-container>
            </g>
          </svg>
          <div class="donut-legend">
            <div class="legend-item" *ngFor="let s of stockStatus">
              <span class="dot" [style.background]="s.color"></span>
              <span>{{ s.label }} ({{ s.value }})</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
