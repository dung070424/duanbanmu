<div class="page-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="page-header-content">
      <div class="page-title">
        <h1>Quản lý Loại Mũ Bảo Hiểm</h1>
      </div>
      <div class="page-actions">
        <button class="btn-add" (click)="openAddModal()">
          <i class="bi bi-plus-circle"></i> Thêm mới
        </button>
      </div>
    </div>
  </div>

  <!-- Content Section -->
  <div class="page-content">
    <div class="content-card">
      <!-- Search and Filter -->
      <div class="search-filters">
        <div class="search-group">
          <div class="input-group">
            <span class="input-group-text"><i class="bi bi-search"></i></span>
            <input
              type="text"
              class="form-control"
              placeholder="Tìm kiếm theo tên loại mũ hoặc mô tả..."
              [(ngModel)]="keyword"
              (input)="onSearchChange()"
            />
          </div>
        </div>
        <div class="filter-group">
          <select class="form-select" [(ngModel)]="trangThai" (change)="onStatusChange()">
            <option *ngFor="let option of statusOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>
      </div>

      <!-- Loading indicator -->
      <div *ngIf="loading" class="loading-container">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Đang tải...</span>
        </div>
        <p class="loading-text">Đang tải dữ liệu...</p>
      </div>

      <!-- Table -->
      <div class="table-container" *ngIf="!loading">
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th style="width: 5%" (click)="setSort('id')" class="sortable">
                ID <i [class]="getSortIcon('id')"></i>
              </th>
              <th style="width: 25%" (click)="setSort('tenLoai')" class="sortable">
                Tên loại mũ <i [class]="getSortIcon('tenLoai')"></i>
              </th>
              <th style="width: 40%">Mô tả</th>
              <th style="width: 15%" (click)="setSort('trangThai')" class="sortable">
                Trạng thái <i [class]="getSortIcon('trangThai')"></i>
              </th>
              <th style="width: 15%">Thao tác</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of items">
              <td>{{ item.id }}</td>
              <td>
                <strong>{{ item.tenLoai }}</strong>
              </td>
              <td>
                <span *ngIf="item.moTa; else noDescription">{{ item.moTa }}</span>
                <ng-template #noDescription>
                  <span class="text-muted">Chưa có mô tả</span>
                </ng-template>
              </td>
              <td>
                <span [class]="getStatusBadgeClass(item.trangThai)">
                  {{ getStatusText(item.trangThai) }}
                </span>
              </td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button
                    class="btn btn-outline-primary"
                    (click)="openEditModal(item)"
                    title="Chỉnh sửa"
                  >
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" (click)="confirmDelete(item)" title="Xóa">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="items.length === 0">
              <td colspan="5" class="text-center text-muted py-4">
                <i class="bi bi-inbox display-4 d-block mb-2"></i>
                Không có dữ liệu
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination-container">
        <div class="pagination-buttons">
          <button class="btn btn-outline-secondary" (click)="prevPage()" [disabled]="page === 0">
            Trang trước
          </button>
          <button
            class="btn btn-outline-secondary"
            (click)="nextPage()"
            [disabled]="page >= totalPages - 1"
          >
            Trang sau
          </button>
        </div>
        <div class="pagination-info">
          <span class="page-info">Trang {{ page + 1 }}/{{ totalPages }}</span>
          <select
            class="form-select page-size-select"
            [(ngModel)]="size"
            (change)="changePageSize(size)"
          >
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="50">50</option>
          </select>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div
  class="modal fade"
  [class.show]="showModal"
  [style.display]="showModal ? 'block' : 'none'"
  tabindex="-1"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ isEdit ? 'Chỉnh sửa' : 'Thêm mới' }} Loại Mũ Bảo Hiểm</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="tenLoai" class="form-label"
              >Tên loại mũ bảo hiểm <span class="text-danger">*</span></label
            >
            <input
              type="text"
              class="form-control"
              id="tenLoai"
              [(ngModel)]="form.tenLoai"
              name="tenLoai"
              placeholder="Nhập tên loại mũ bảo hiểm"
              required
            />
          </div>

          <div class="mb-3">
            <label for="moTa" class="form-label">Mô tả</label>
            <textarea
              class="form-control"
              id="moTa"
              [(ngModel)]="form.moTa"
              name="moTa"
              rows="3"
              placeholder="Nhập mô tả (tùy chọn)"
            ></textarea>
          </div>

          <div class="mb-3">
            <label for="trangThai" class="form-label">Trạng thái</label>
            <select
              class="form-select"
              id="trangThai"
              [(ngModel)]="form.trangThai"
              name="trangThai"
            >
              <option [value]="true">Đang dùng</option>
              <option [value]="false">Không dùng nữa</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">Hủy</button>
        <button type="button" class="btn btn-primary" (click)="save()">
          {{ isEdit ? 'Cập nhật' : 'Thêm mới' }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal backdrop -->
<div
  class="modal-backdrop fade"
  [class.show]="showModal"
  [style.display]="showModal ? 'block' : 'none'"
></div>
